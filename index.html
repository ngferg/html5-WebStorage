<!DOCTYPE html>
<html>
	<head>
		<Title>HTML WebStorage</title>
		<script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
		<script>
			$(function(){
				p1();
				if(localStorage.getItem("visited") != 1){
					localStorage.setItem("visited", 1);
					localStorage.setItem("firstVisited", Date());
				}
				$("#when").html(localStorage.getItem("firstVisited"));
			});

			function sub(){
				localStorage.setItem("subbed", "true");
				localStorage.setItem("name", $("#name").val());
				p1();
			}

			function unSub(){
				localStorage.setItem("subbed", "false");
				p1();
			}

			function p1(){
				if(localStorage.getItem("subbed") == "true"){
					//console.log("true");
					$("#box").html(
						"<p>Your name is " + localStorage.getItem("name") +"</p>" +
						"<p><button type='button' onclick='unSub()'>Change name</button></p>"
					);
				} else {
					//console.log("false");
					$("#box").html(
						"<p>Enter your name: <input type='text' id='name'></p>" +
						"<p><button type='button' onclick='sub()'>Enter</button></p>"
					);
				}
			}
		</script>
	</head>

	<body>
		<h3>You first visited this page on <span id="when"></span>
		<noscript>Please turn on javascript</noscript>.</h3>
		<div id="box">
			<p>Enter your name: <input type="text" id="name"></p>
			<p><button type="button" onclick="sub()">Enter</button></p>
		</div>
	</body>
</html>
